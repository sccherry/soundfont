!function(t){var e={};function n(r){if(e[r])return e[r].exports;var o=e[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(r,o,function(e){return t[e]}.bind(null,o));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=7)}([function(t,e,n){t.exports=n(2).Observable},function(t,e,n){t.exports=n(5)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var i=function(){return"function"==typeof Symbol},u=function(t){return i()&&Boolean(Symbol[t])},a=function(t){return u(t)?Symbol[t]:"@@"+t};i()&&!u("observable")&&(Symbol.observable=Symbol("observable"));var c=a("iterator"),s=a("observable"),f=a("species");function l(t,e){var n=t[e];if(null!=n){if("function"!=typeof n)throw new TypeError(n+" is not a function");return n}}function p(t){var e=t.constructor;return void 0!==e&&null===(e=e[f])&&(e=void 0),void 0!==e?e:A}function v(t){return t instanceof A}function h(t){h.log?h.log(t):setTimeout(function(){throw t})}function y(t){Promise.resolve().then(function(){try{t()}catch(t){h(t)}})}function d(t){var e=t._cleanup;if(void 0!==e&&(t._cleanup=void 0,e))try{if("function"==typeof e)e();else{var n=l(e,"unsubscribe");n&&n.call(e)}}catch(t){h(t)}}function b(t){t._observer=void 0,t._queue=void 0,t._state="closed"}function m(t,e,n){t._state="running";var r=t._observer;try{var o=l(r,e);switch(e){case"next":o&&o.call(r,n);break;case"error":if(b(t),!o)throw n;o.call(r,n);break;case"complete":b(t),o&&o.call(r)}}catch(t){h(t)}"closed"===t._state?d(t):"running"===t._state&&(t._state="ready")}function g(t,e,n){if("closed"!==t._state){if("buffering"!==t._state)return"ready"!==t._state?(t._state="buffering",t._queue=[{type:e,value:n}],void y(function(){return function(t){var e=t._queue;if(e){t._queue=void 0,t._state="ready";for(var n=0;n<e.length&&(m(t,e[n].type,e[n].value),"closed"!==t._state);++n);}}(t)})):void m(t,e,n);t._queue.push({type:e,value:n})}}var w=function(){function t(e,n){o(this,t),this._cleanup=void 0,this._observer=e,this._queue=void 0,this._state="initializing";var r=new x(this);try{this._cleanup=n.call(void 0,r)}catch(t){r.error(t)}"initializing"===this._state&&(this._state="ready")}return r(t,[{key:"unsubscribe",value:function(){"closed"!==this._state&&(b(this),d(this))}},{key:"closed",get:function(){return"closed"===this._state}}]),t}(),x=function(){function t(e){o(this,t),this._subscription=e}return r(t,[{key:"next",value:function(t){g(this._subscription,"next",t)}},{key:"error",value:function(t){g(this._subscription,"error",t)}},{key:"complete",value:function(){g(this._subscription,"complete")}},{key:"closed",get:function(){return"closed"===this._subscription._state}}]),t}(),A=e.Observable=function(){function t(e){if(o(this,t),!(this instanceof t))throw new TypeError("Observable cannot be called as a function");if("function"!=typeof e)throw new TypeError("Observable initializer must be a function");this._subscriber=e}return r(t,[{key:"subscribe",value:function(t){return"object"==typeof t&&null!==t||(t={next:t,error:arguments[1],complete:arguments[2]}),new w(t,this._subscriber)}},{key:"forEach",value:function(t){var e=this;return new Promise(function(n,r){if("function"==typeof t)var o=e.subscribe({next:function(e){try{t(e,i)}catch(t){r(t),o.unsubscribe()}},error:r,complete:n});else r(new TypeError(t+" is not a function"));function i(){o.unsubscribe(),n()}})}},{key:"map",value:function(t){var e=this;if("function"!=typeof t)throw new TypeError(t+" is not a function");return new(p(this))(function(n){return e.subscribe({next:function(e){try{e=t(e)}catch(t){return n.error(t)}n.next(e)},error:function(t){n.error(t)},complete:function(){n.complete()}})})}},{key:"filter",value:function(t){var e=this;if("function"!=typeof t)throw new TypeError(t+" is not a function");return new(p(this))(function(n){return e.subscribe({next:function(e){try{if(!t(e))return}catch(t){return n.error(t)}n.next(e)},error:function(t){n.error(t)},complete:function(){n.complete()}})})}},{key:"reduce",value:function(t){var e=this;if("function"!=typeof t)throw new TypeError(t+" is not a function");var n=p(this),r=arguments.length>1,o=!1,i=arguments[1],u=i;return new n(function(n){return e.subscribe({next:function(e){var i=!o;if(o=!0,!i||r)try{u=t(u,e)}catch(t){return n.error(t)}else u=e},error:function(t){n.error(t)},complete:function(){if(!o&&!r)return n.error(new TypeError("Cannot reduce an empty sequence"));n.next(u),n.complete()}})})}},{key:"concat",value:function(){for(var t=this,e=arguments.length,n=Array(e),r=0;r<e;r++)n[r]=arguments[r];var o=p(this);return new o(function(e){var r=void 0,i=0;return function t(u){r=u.subscribe({next:function(t){e.next(t)},error:function(t){e.error(t)},complete:function(){i===n.length?(r=void 0,e.complete()):t(o.from(n[i++]))}})}(t),function(){r&&(r.unsubscribe(),r=void 0)}})}},{key:"flatMap",value:function(t){var e=this;if("function"!=typeof t)throw new TypeError(t+" is not a function");var n=p(this);return new n(function(r){var o=[],i=e.subscribe({next:function(e){if(t)try{e=t(e)}catch(t){return r.error(t)}var i=n.from(e).subscribe({next:function(t){r.next(t)},error:function(t){r.error(t)},complete:function(){var t=o.indexOf(i);t>=0&&o.splice(t,1),u()}});o.push(i)},error:function(t){r.error(t)},complete:function(){u()}});function u(){i.closed&&0===o.length&&r.complete()}return function(){o.forEach(function(t){return t.unsubscribe()}),i.unsubscribe()}})}},{key:s,value:function(){return this}}],[{key:"from",value:function(e){var n="function"==typeof this?this:t;if(null==e)throw new TypeError(e+" is not an object");var r=l(e,s);if(r){var o=r.call(e);if(Object(o)!==o)throw new TypeError(o+" is not an object");return v(o)&&o.constructor===n?o:new n(function(t){return o.subscribe(t)})}if(u("iterator")&&(r=l(e,c)))return new n(function(t){y(function(){if(!t.closed){var n=!0,o=!1,i=void 0;try{for(var u,a=r.call(e)[Symbol.iterator]();!(n=(u=a.next()).done);n=!0){var c=u.value;if(t.next(c),t.closed)return}}catch(t){o=!0,i=t}finally{try{!n&&a.return&&a.return()}finally{if(o)throw i}}t.complete()}})});if(Array.isArray(e))return new n(function(t){y(function(){if(!t.closed){for(var n=0;n<e.length;++n)if(t.next(e[n]),t.closed)return;t.complete()}})});throw new TypeError(e+" is not observable")}},{key:"of",value:function(){for(var e=arguments.length,n=Array(e),r=0;r<e;r++)n[r]=arguments[r];var o="function"==typeof this?this:t;return new o(function(t){y(function(){if(!t.closed){for(var e=0;e<n.length;++e)if(t.next(n[e]),t.closed)return;t.complete()}})})}},{key:f,get:function(){return this}}]),t}();i()&&Object.defineProperty(A,Symbol("extensions"),{value:{symbol:s,hostReportError:h},configurable:!0})},function(t,e,n){t.exports=function(){return new Worker(n.p+"js/f354bf24618a272f02eb.worker.js")}},function(t,e){!function(t,e,n){"use strict";function r(t){t&&(t.setTargetAtTime||(t.setTargetAtTime=t.setTargetValueAtTime))}window.hasOwnProperty("webkitAudioContext")&&!window.hasOwnProperty("AudioContext")&&(window.AudioContext=webkitAudioContext,AudioContext.prototype.hasOwnProperty("createGain")||(AudioContext.prototype.createGain=AudioContext.prototype.createGainNode),AudioContext.prototype.hasOwnProperty("createDelay")||(AudioContext.prototype.createDelay=AudioContext.prototype.createDelayNode),AudioContext.prototype.hasOwnProperty("createScriptProcessor")||(AudioContext.prototype.createScriptProcessor=AudioContext.prototype.createJavaScriptNode),AudioContext.prototype.hasOwnProperty("createPeriodicWave")||(AudioContext.prototype.createPeriodicWave=AudioContext.prototype.createWaveTable),AudioContext.prototype.internal_createGain=AudioContext.prototype.createGain,AudioContext.prototype.createGain=function(){var t=this.internal_createGain();return r(t.gain),t},AudioContext.prototype.internal_createDelay=AudioContext.prototype.createDelay,AudioContext.prototype.createDelay=function(t){var e=t?this.internal_createDelay(t):this.internal_createDelay();return r(e.delayTime),e},AudioContext.prototype.internal_createBufferSource=AudioContext.prototype.createBufferSource,AudioContext.prototype.createBufferSource=function(){var t=this.internal_createBufferSource();return t.start?(t.internal_start=t.start,t.start=function(e,n,r){void 0!==r?t.internal_start(e||0,n,r):t.internal_start(e||0,n||0)}):t.start=function(t,e,n){e||n?this.noteGrainOn(t||0,e,n):this.noteOn(t||0)},t.stop?(t.internal_stop=t.stop,t.stop=function(e){t.internal_stop(e||0)}):t.stop=function(t){this.noteOff(t||0)},r(t.playbackRate),t},AudioContext.prototype.internal_createDynamicsCompressor=AudioContext.prototype.createDynamicsCompressor,AudioContext.prototype.createDynamicsCompressor=function(){var t=this.internal_createDynamicsCompressor();return r(t.threshold),r(t.knee),r(t.ratio),r(t.reduction),r(t.attack),r(t.release),t},AudioContext.prototype.internal_createBiquadFilter=AudioContext.prototype.createBiquadFilter,AudioContext.prototype.createBiquadFilter=function(){var t=this.internal_createBiquadFilter();return r(t.frequency),r(t.detune),r(t.Q),r(t.gain),t},AudioContext.prototype.hasOwnProperty("createOscillator")&&(AudioContext.prototype.internal_createOscillator=AudioContext.prototype.createOscillator,AudioContext.prototype.createOscillator=function(){var t=this.internal_createOscillator();return t.start?(t.internal_start=t.start,t.start=function(e){t.internal_start(e||0)}):t.start=function(t){this.noteOn(t||0)},t.stop?(t.internal_stop=t.stop,t.stop=function(e){t.internal_stop(e||0)}):t.stop=function(t){this.noteOff(t||0)},t.setPeriodicWave||(t.setPeriodicWave=t.setWaveTable),r(t.frequency),r(t.detune),t})),window.hasOwnProperty("webkitOfflineAudioContext")&&!window.hasOwnProperty("OfflineAudioContext")&&(window.OfflineAudioContext=webkitOfflineAudioContext)}(window)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.merge=function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];return new r.Observable(function(t){if(0===e.length)return r.Observable.from([]);var n=e.length,o=e.map(function(e){return r.Observable.from(e).subscribe({next:function(e){t.next(e)},error:function(e){t.error(e)},complete:function(){0==--n&&t.complete()}})});return function(){return o.forEach(function(t){return t.unsubscribe()})}})},e.combineLatest=function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];return new r.Observable(function(t){if(0===e.length)return r.Observable.from([]);var n=e.length,o=new Set,i=!1,u=e.map(function(){}),a=e.map(function(a,c){return r.Observable.from(a).subscribe({next:function(n){if(u[c]=n,!i){if(o.add(c),o.size!==e.length)return;o=null,i=!0}t.next(Array.from(u))},error:function(e){t.error(e)},complete:function(){0==--n&&t.complete()}})});return function(){return a.forEach(function(t){return t.unsubscribe()})}})},e.zip=function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];return new r.Observable(function(t){if(0===e.length)return r.Observable.from([]);var n=e.map(function(){return[]});function o(){return n.some(function(t,e){return 0===t.length&&i[e].closed})}var i=e.map(function(e,i){return r.Observable.from(e).subscribe({next:function(e){n[i].push(e),n.every(function(t){return t.length>0})&&(t.next(n.map(function(t){return t.shift()})),o()&&t.complete())},error:function(e){t.error(e)},complete:function(){o()&&t.complete()}})});return function(){return i.forEach(function(t){return t.unsubscribe()})}})};var r=n(2)},function(t,e,n){},function(t,e,n){"use strict";n.r(e);var r=n(0),o=n.n(r),i=function(t){return new o.a(function(e){t.then(function(t){e.next(t),e.complete()}).catch(function(t){e.error(t)})})},u=function(t){return Array.from(t).sort(function(t,e){return t[0]-e[0]}).map(function(t){return t[1]})},a=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return new o.a(function(t){if(0===e.length)return o.a.from([]);var n=e.length,r=new Map,i=e.map(function(i,a){return o.a.from(i).subscribe({next:function(n){r.set(a,n),r.size===e.length&&0===a&&t.next(u(r))},error:function(e){t.error(e)},complete:function(){0===(n-=1)&&t.complete()}})});return function(){return i.forEach(function(t){return t.unsubscribe()})}})},c=n(3),s=new(n.n(c).a);function f(t){var e=t.context,n=t.buffers,r=[];return n.forEach(function(t,n){r.push(e.decodeAudioData(t).then(function(t){return[n,t]}))}),Promise.all(r).then(function(t){return new Map(t)})}function l(t){return s.postMessage(t),new Promise(function(t,e){function n(e){t(e.data),s.removeEventListener("message",n),s.removeEventListener("error",r)}function r(t){e(t.message),s.removeEventListener("message",n),s.removeEventListener("error",r)}s.addEventListener("message",n),s.addEventListener("error",r)})}function p(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var v=function(){function t(e,n){var r=n.attack,o=void 0===r?.01:r,i=n.decay,u=void 0===i?.1:i,a=n.sustain,c=void 0===a?.5:a,s=n.release,f=void 0===s?1:s;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.context=e,this.param=null,this.attack=o,this.decay=u,this.sustain=c,this.release=f}var e,n,r;return e=t,(n=[{key:"triggerAttack",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.context.currentTime,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return null!==this.param&&(this.param.setValueAtTime(0,t),this.param.linearRampToValueAtTime(e,t+this.attack),this.param.linearRampToValueAtTime(e*this.sustain,t+this.attack+this.decay)),this}},{key:"triggerRelease",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.context.currentTime;return null!==this.param&&this.param.linearRampToValueAtTime(0,t+this.release),this}},{key:"triggerAttackRelease",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.context.currentTime,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return this.triggerAttack(e,n),this.triggerRelease(e+t),this}},{key:"connect",value:function(t){return this.param=t,this}},{key:"disconnect",value:function(){return this.param=null,this}}])&&p(e.prototype,n),r&&p(e,r),t}();function h(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var y=function(){function t(e,n){var r=n.envelope;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.context=e,this.gain=this.context.createGain(),this.envelope=new v(this.context,r),this.envelope.connect(this.gain.gain)}var e,n,r;return e=t,(n=[{key:"triggerAttack",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.context.currentTime,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return this.source||(this.source=this.context.createBufferSource(),this.source.connect(this.gain),this.source.buffer=t,this.envelope.triggerAttack(e,n),this.source.start(e)),this}},{key:"triggerRelease",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.context.currentTime;return this.source&&(this.source.onended=function(){t.source.disconnect(),t.source=null},this.envelope.triggerRelease(e),this.source.stop(e+this.envelope.release)),this}},{key:"connect",value:function(t){return this.gain.connect(t),this}},{key:"disconnect",value:function(t){return this.gain.disconnect(t),this}}])&&h(e.prototype,n),r&&h(e,r),t}();function d(t,e,n){return(d=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}()?Reflect.construct:function(t,e,n){var r=[null];r.push.apply(r,e);var o=new(Function.bind.apply(t,r));return n&&b(o,n.prototype),o}).apply(null,arguments)}function b(t,e){return(b=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function m(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var g=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.context=e,this.Voice=n,this.cache=new Map}var e,n,r;return e=t,(n=[{key:"triggerAttack",value:function(t){for(var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.context.currentTime,r=arguments.length>2?arguments[2]:void 0,o=arguments.length>3?arguments[3]:void 0,i=arguments.length,u=new Array(i>4?i-4:0),a=4;a<i;a++)u[a-4]=arguments[a];var c=Array.isArray(t)?t:[t];return c.forEach(function(t){if(!e.cache.has(t)){var i=d(e.Voice,[e.context].concat(u)).connect(e.output);e.cache.set(t,i),i.triggerAttack(o,n,r/127)}}),this}},{key:"triggerRelease",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.context.currentTime,r=Array.isArray(t)?t:[t];return r.forEach(function(t){e.cache.has(t)&&(e.cache.get(t).triggerRelease(n),e.cache.delete(t))}),this}},{key:"triggerAttackRelease",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.context.currenTime,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;return this.triggerAttack(t,n,r),this.triggerRelease(t,n+e),this}},{key:"connect",value:function(t){return this.output=t,this}},{key:"disconnect",value:function(){return this.output=null,this}}])&&m(e.prototype,n),r&&m(e,r),t}(),w=(n(4),null);function x(t,e){t.addEventListener(e,function n(){null!==w&&(t.removeEventListener(e,n),"suspended"===w.state&&w.resume().then(function(){console.log("Audio context resumed")}))},!1)}x(window,"mousedown"),x(window,"touchstart");var A=function(t,e,n){var r=Math.floor(t/16),o=t%16;return 8===r||9===r&&0===n?{status:r,channel:o,note:e,velocity:n}:9===r?{status:r,channel:o,note:e,velocity:n}:14===r?{status:r,channel:o,value:(128*n+e-8192)/8192}:{status:r,channel:o,data0:e,data1:n}},k=function(t,e){return new o.a(function(n){var r=function(t){return n.next(t)};return t.addEventListener(e,r),function(){return t.removeEventListener(e,r)}})},_=function(t,e){return new o.a(function(n){n.next(e);var r=t.subscribe({next:function(t){n.next(t)},error:function(t){n.error(t)},complete:function(){n.complete()}});return function(){return r.unsubscribe()}})},O=document.querySelector("form");if(localStorage.getItem("soundfont")){var C=JSON.parse(localStorage.getItem("soundfont")),T=O.elements;Object.keys(C).forEach(function(t){var e=T.namedItem(t);if("checkbox"===e.type){var n="on"===C[t];e.checked=n}else e.value=C[t]})}var E=_(k(O,"change"),new FormData(O)).map(function(){return new FormData(O)}),S=E;E.subscribe(function(t){var e={};t.forEach(function(t,n){e[n]=t}),localStorage.setItem("soundfont",JSON.stringify(e))});var P=S.map(function(t){return{attack:parseFloat(t.get("envelope-attack")),decay:parseFloat(t.get("envelope-decay")),sustain:parseFloat(t.get("envelope-sustain")),release:parseFloat(t.get("envelope-release"))}}),j=S.map(function(t){return{instrument:t.get("instrument"),soundfont:t.get("soundfont")}}),D=n(1),R=function(t,e){return 12*t+e},M=function(t){return new o.a(function(e){var n,r=t.subscribe({next:function(t){var r=n===t;n=t,r||e.next(t)},error:function(t){e.error(t)},complete:function(){e.complete()}});return function(){return r.unsubscribe()}})}(S.map(function(t){return parseInt(t.get("octave"),10)}));function q(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,o=!1,i=void 0;try{for(var u,a=t[Symbol.iterator]();!(r=(u=a.next()).done)&&(n.push(u.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{r||null==a.return||a.return()}finally{if(o)throw i}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var I="awsedftgyhujk",L=function(t){return function(e){return t.includes(e.key.toLowerCase())}},F=function(t){var e=q(t,2),n=e[0],r=e[1],o=I.indexOf(n.key.toLowerCase());return R(n.shiftKey?r+1:r,o)},B=k(document,"keydown").filter(function(t){return!t.repeat}),G=k(document,"keyup"),W=a(B.filter(L(I)),M).map(F).map(function(t){return A(144,t,127)}),V=a(G.filter(L(I)),M).map(F).map(function(t){return A(128,t,0)}),z=Object(D.merge)(W,V);function N(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var J=function(){return new o.a(function(t){void 0===navigator.requestMIDIAccess?t.complete():navigator.requestMIDIAccess().then(function(e){var n=e;t.next(n),n.onstatechange=function(e){"open"!==e.port.connection&&t.next(e.target)}}).catch(function(e){t.error(e)})})}().map(function(t){return t.inputs}).flatMap(function(t){return o.a.from(Array.from(t.values()))}).flatMap(function(t){return k(t,"midimessage")}).map(function(t){return A.apply(void 0,N(t.data))});function K(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,o=!1,i=void 0;try{for(var u,a=t[Symbol.iterator]();!(r=(u=a.next()).done)&&(n.push(u.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{r||null==a.return||a.return()}finally{if(o)throw i}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var Q=document.querySelector(".piano-roll"),H=function(t){return 32===t||13===t},U=function(t){var e=K(t,2),n=e[0],r=e[1];return R(r,parseInt(n.target.dataset.note,10))},X=Object(D.merge)(k(Q,"mousedown"),k(Q,"touchstart"),k(Q,"keydown").filter(function(t){return!t.repeat}).filter(function(t){return H(t.keyCode)})),Y=Object(D.merge)(k(Q,"mouseup"),k(Q,"touchend"),k(Q,"keyup").filter(function(t){return H(t.keyCode)})),Z=Object(D.merge)(a(X,M).map(U).map(function(t){return A(144,t,127)}),a(Y,M).map(U).map(function(t){return A(128,t,0)}));X.subscribe(function(t){t.preventDefault(),t.target.setAttribute("aria-pressed","true")}),Y.subscribe(function(t){t.preventDefault(),t.target.setAttribute("aria-pressed","false")});var $=Object(D.merge)(z,Z,J);function tt(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,o=!1,i=void 0;try{for(var u,a=t[Symbol.iterator]();!(r=(u=a.next()).done)&&(n.push(u.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{r||null==a.return||a.return()}finally{if(o)throw i}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var et=(null===w&&(w=new AudioContext),w),nt=j.flatMap(function(t){var e=t.soundfont,n=t.instrument;return i(function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"acoustic_grand_piano",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"FluidR3_GM";return l({instrument:e,soundfont:n}).then(function(e){return f({context:t,buffers:e})})}(et,n,e))}),rt=new g(et,y).connect(et.destination);a($,nt,P).subscribe(function(t){var e=tt(t,3),n=e[0],r=e[1],o=e[2];switch(n.status){case 9:var i=n.note,u=n.velocity;rt.triggerAttack(i,et.currentTime,u,r.get(i),{envelope:o});break;case 8:var a=n.note;rt.triggerRelease(a)}});n(6);void 0!==navigator.serviceWorker&&navigator.serviceWorker.register("./service-worker.js")}]);
//# sourceMappingURL=main.js.map